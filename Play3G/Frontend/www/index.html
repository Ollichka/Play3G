<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    Как к доставать ваш Google+ профиль info и другие деятельности с помощью Google JS API
    <link href="css/main.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">// <![CDATA[
    google.load("jquery", "1.7.1");

    // ]]></script>
    <script type="text/javascript" src="js/jsrender.js"></script>
    <!-- define template for our units -->
    <script id="gplusTemplate" type="text/x-jsrender">// <![CDATA[

<div id="{{>id}}" class="gp">
            <img src="{{:actor.image.url}}" />
<div>

   <a href="{{:actor.url}}" target="_blank">{{:actor.displayName}}</a><span>{{:published}}</span>
   <a href="{{:url}}" target="_blank">{{:title}}</a>
   {{:object.content}}
 </div>
</div>
// ]]></script>

    <img class="google" alt="google plus" src="google-plus.jpg" /></pre>
    <center>
        <button id="login" style="visibility: hidden;">Авторизация</button>
        <div id="author"></div>
        <div id="actList"></div>
    </center>

    <script type="text/javascript">// <![CDATA[
    // Your client ID
    var clientId = 'YOUR_CLIENT_ID_KEY';

    // Your API key
    var apiKey = 'YOUR_API_KEY';

    // The authorization scope
    var scopes = 'https://www.googleapis.com/auth/plus.me';

    // onliad initialization
    function onloadInitialization() {
        // set our own api key
        gapi.client.setApiKey(apiKey);

        // and checkAuth in 1 ms
        window.setTimeout(checkAuth, 1);
    }

    // check authorization
    function checkAuth() {
        gapi.auth.authorize({
            client_id: clientId,
            scope: scopes,
            immediate: true
        }, handleAuthResult);
    }

    // handle authorization result
    function handleAuthResult(authResult) {
        var authorizeButton = document.getElementById('login');
        if (authResult && ! authResult.error) {
            authorizeButton.style.visibility = 'hidden';
            makeGoogleApiCalls();
        } else {
            authorizeButton.style.visibility = '';
            authorizeButton.onclick = handleAuthClick;
        }
    }

    // handle onclick event of Login button
    function handleAuthClick(event) {
        gapi.auth.authorize({
            client_id: clientId,
            scope: scopes,
            immediate: false
        }, handleAuthResult);

        return false;
    }

    // make Google API calls: obtain logged-in member info and activity of friends
    function makeGoogleApiCalls() {
        gapi.client.load('plus', 'v1', function() {

            // Request1: obtain logged-in member info
            var request = gapi.client.plus.people.get({
                'userId': 'me'
            });
            request.execute(function(aInfo) {

                // prepare author info array for rendering
                var authorInfo = [
                    {
                        'id': aInfo.id,
                        'actor': {'image': {'url': aInfo.image.url}, 'url': aInfo.url, 'displayName': aInfo.displayName},
                        'published': '',
                        'url': aInfo.url,
                        'title': 'My page at G+',
                        'object': {'content': ''}
                    }
                ];
                // and render it using 'gplusTemplate' template
                $('#author').html(
                        $('#gplusTemplate').render(authorInfo)
                );
            });

            // Request2: obtain friend's activity feed
            var restRequest = gapi.client.request({
                'path': '/plus/v1/activities',
                'params': {'query': 'Google+', 'orderBy': 'best'}
            });
            restRequest.execute(function(activityInfo) {

                // render activity items using 'gplusTemplate' template
                $('#actList').html(
                        $('#gplusTemplate').render(activityInfo.items)
                );
            });
        });
    }

    // ]]></script>
    <script type="text/javascript" src="https://apis.google.com/js/client.js?onload=onloadInitialization"></script>
</head>
<body>
<button id="login" style="visibility: hidden;">Авторизация</button></pre>
<div id="author"></div>
<div id="actList"></div>
</body>
</html>
